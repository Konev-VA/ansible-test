---
- name: Docker install
  hosts: all
  remote_user: user
  become: true
  tasks:
    - name: pull project
      ansible.builtin.git:
        repo: https://github.com/Konev-VA/test-ansible-helloworld.git
        dest: /home/test-ansible-helloworld
    - name: install docker
      dnf:
        name:
          - docker-ce 
          - docker-ce-cli 
          - containerd.io 
          - docker-buildx-plugin 
          - docker-compose-plugin
        state: latest
        update_cache: yes
    - name: check docker is active
      service:
        name: docker
        state: started
        enabled: yes
    - name: Ensure group "docker" exists
      ansible.builtin.group:
        name: docker
        state: present
    - name: adding user to docker group
      user:
        name: user
        groups: docker
        append: yes
    - name: Change file ownership, group and permissions
      ansible.builtin.file:
        path: /usr/local/bin/docker-compose
        owner: user
        group: user